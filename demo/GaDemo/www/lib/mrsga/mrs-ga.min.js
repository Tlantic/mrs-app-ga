angular.module("MRS.GoogleAnalytics",[]),angular.module("MRS.GoogleAnalytics").service("GAnalytics",["$mrsgoogleanalyticsConfig","$window","$location",function(a,b,c){"use strict";var d,e,f,g=this,h=!1,i=a.debug,j="MRS.GoogleAnalytics: ",k=a.trackRoutes,l=a.accountId,m=a.trackPrefix,n=a.pageEvents,o=a.ecommerce.active,p=a.ecommerce.currency,q=a.enhancedLinkAttribution,r=a.ignoreFirstPageLoad,s=a.scriptPath;this._logs=[],this.getUrl=function(){var a=c.path();return e?a.replace(e,""):a},this.log=function(){i&&console.info(j+"Log:",arguments)},this.trackPage=function(a){b.ga&&(b.ga("send","pageview",m+a),this.log("pageview",arguments))},this.trackEvent=function(a,c,d,e){b.ga&&(b.ga("send","event",a,c,d,e),this.log("event",arguments))},this.addTrans=function(a,c,d,e,f,g,h,i,k){if(b.ga){if(!o)return void console.warn(j+"ecommerce no set. Use AnalyticsProvider.setECommerce(true);");b.ga("ecommerce:addTransaction",{id:a,affiliation:c,revenue:d,tax:e,shipping:f,currency:k||p}),this.log("ecommerce:addTransaction",arguments)}},this.addItem=function(a,c,d,e,f,g){b.ga&&(b.ga("ecommerce:addItem",{id:a,name:d,sku:c,category:e,price:f,quantity:g}),this.log("ecommerce:addItem",arguments))},this.trackTrans=function(){b.ga&&(b.ga("ecommerce:send"),this.log("ecommerce:send",arguments))},this._clearTrans=function(){b.ga&&(b.ga("ecommerce:clear"),this.log("ecommerce:clear",arguments))},this.send=function(a){b.ga&&(b.ga("send",a),this.log("send",a))};var t=function(){if(!l)return console.warn(j+"No account id set for Analytics.js");if(!s)return console.warn(j+"Analytics.js not defined");if(function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script",s,"ga"),b.ga("create",l,d),k&&!r&&b.ga("send","pageview",g.getUrl()),o&&b.ga("require","ecommerce","ecommerce.js"),q&&b.ga("require","linkid","linkid.js"),f){var a=document.createElement("script"),c=document.getElementsByTagName("script")[0];a.src="//www.google-analytics.com/cx/api.js?experiment="+f,c.parentNode.insertBefore(a,c)}},u=function(){if(h||(t(),h=!0),k)for(var a=function(){g.trackPage(g.getUrl())},b=0;b<n.lenght;b++)$rootScope.$on(n[b],a)};this.init=function(a){d=a,u()}}]);